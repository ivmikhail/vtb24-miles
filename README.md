# vtb24-miles

[![Codacy Badge](https://api.codacy.com/project/badge/Grade/5420977c69824cce879294432154eb58)](https://app.codacy.com/app/ivmikhail/vtb24-miles?utm_source=github.com&utm_medium=referral&utm_content=ivmikhail/vtb24-miles&utm_campaign=badger) 
[![Build Status](https://travis-ci.org/ivmikhail/vtb24-miles.svg?branch=master)](https://travis-ci.org/ivmikhail/vtb24-miles)

Приспособа для подсчета мильного/бонусного вознаграждения карт ВТБ24. Поддерживаются:
 * Карта Мира, Platinum/Gold https://www.vtb24.ru/cards/credit/platinum/worldcard/
 * Мультикарта c опцией путешестия/коллекция/cashback https://www.vtb24.ru/cards/multicard/

Полезно для сверки с расчетом Банка

## Как использовать

### Системные требования

* Подойдет любая ОС: Windows, Mac и т.п
* У вас должна быть установлена Java 8 и выше
  * Скорее всего, она у вас уже установлена. Но если нет, [скачайте отсюда](https://www.java.com/ru/download/)
  * [Подробная инструкция по установке](https://www.java.com/ru/download/help/download_options.xml), если у вас возникли трудности
  
### Как пользоваться

1. Скачайте последнюю версию программы здесь - https://github.com/ivmikhail/vtb24-miles/releases/
   * Нужен `*.jar` файл
1. Скачайте выписку по операциям
   * https://online.vtb.ru > аутентифицируйтесь > найдите нужную карту > выписка > выберите период > "Показать" > Экспорт > CSV
   * Рекомендую выбрать весь период использования карты. Месяц можно будет указать при анализе выписки
   * Положите выписку (обычно называется `statement.csv`) в ту директорию, куда вы скачали `*.jar` файл
1. Откройте терминал, перейдите в директорию где лежит выписка и программа
1. Запустите анализ, введя команду `java -jar vtb24-miles-1.5.jar -s statement.csv`. Программа напечатает отчет
  1. Чтобы сохранить результат в формате `csv` выполните `java -jar vtb24-miles-1.5.jar -s statement.csv -export 1.csv`
  1. Откройте файл 1.csv, который появился в той же директории с помощью Excel или LibreOffice(если предлагается выбрать кодировку, нужно выставить UTF-8)
  1. Название файла может отличаться, в этом примере - `vtb24-miles-1.5.jar`
1. Чтобы сменить способ начисления миль/бонусов, добавьте ключ `-rule %опция%`, например `-rule MC_TRAVEL`. Поддерживаемые опции: `KM_PLATINUM, KM_GOLD, MC_TRAVEL, MC_CASHBACK`. По умолчанию, бонусы считаются по правилу `KM_PLATINUM`(Карта Мира Платинум)

В примере ниже я сохранил программу и выписку в папке vtb24-miles. Мне нужно посмотреть мили за декабрь 2017г
 
![Как использовать vtb24-miles](/static/howto-v2.gif?raw=true)

#### Параметры запуска

![Параметры запуска](/static/help-v2.png?raw=true)

### Вопросы и ответы

<dl>
  <dt>Счет карты у меня USD(или EUR), как считаются мили?</dt>
  <dd>
    Сумма списания переводится в рубли(т.к 1 миля = 1 руб). Курс берется с сайта ВТБ https://www.vtb24.ru/banking/currency/rate-of-conversion/, на дату проведения операции. От суммы списания в рублях берется 4% или 5%
  </dd>
  
  <dt>Счет карты у меня USD(или EUR), можно ли верить программе насчет миль?</dt>
  <dd>
    В этом случае количество миль будет примерным. Есть нескольким причин: не учитывается комиссия(и/или курс) банка(и/или платежной системы) при конвертации, неизвестно, какой курс использует банк для подсчета миль
  </dd>
  
  <dt>Счет карты у меня RUR, можно ли верить программе насчет миль?</dt>
  <dd>
    По идее, да
  </dd> 
  
  <dt>Какие операции попадают в "заграничные"(кешбэк 5%)?</dt>
  <dd>Те, у которых валюта списания не совпадает с валютой счета и те, в описании которых встречаются слова заданные в конфигурационном файле - https://github.com/ivmikhail/vtb24-miles/blob/master/src/main/resources/app.properties</dd>
    
  <dt>На какие операции не начисляются мили?</dt>
  <dd>Сумма списания  < 100 руб и те, в описании которых встречаются слова заданные в конфигурационном файле - https://github.com/ivmikhail/vtb24-miles/blob/master/src/main/resources/app.properties</dd>
  
  <dt>Почему не используется MCC для определения категории операции?</dt>
  <dd>MCC код операции отсутствует в выписке</dd>
  
  <dt>У меня количество миль не совпадает с тем, что начислил банк</dt>
  <dd>Скорее всего, операции попадают не в ту категорию, проверьте(если выявили проблему см. след. вопрос) или Банк неправильно начислил мили. БИНГО! Пишите претензию в БАНК, а мне благодарность - ivmikhail собака gmail com</dd>
  
  <dt>Я знаю что операция XXX должна быть как "заграничная"/игнорирована. Что мне делать?</dt>
  <dd>Скачайте конфигурацию(https://github.com/ivmikhail/vtb24-miles/blob/master/src/main/resources/app.properties) в директорию программы, измените как нужно, и запустите программу указав конф. файл. Пример: "java -jar vtb24-miles.jar -s statement.csv -p app.properties". Если не трудно, пришлите свой измененный файл мне ivmikhail собака gmail com, я добавлю ваши настройки для всех</dd>
  
  <dt>Как подсчитать мили по 2-м и более Картам Мира(Платинум)?</dt>
  <dd>Скачайте выписку отдельно по каждой карте, см. п. 2. Запустите программу как то так:  
 "java -jar vtb24-miles.jar -s statement.csv -s statement2.csv"</dd>
  
  <dt>У меня большое расхождение миль по операциям проведенным до 1 июля 2017</dt>
  <dd>Тогда были другие правила. ВТБ сконвертировал старые баллы в новые, и сделал это, кажется, без учета каждой транзакции по отдельности. Это могло привести к расхождению. Если вам нужно посчитать старые операции используйте старую версию https://github.com/ivmikhail/vtb24-miles/releases/tag/vtb24-miles-1.1</dd>
 
  <dt>Я хочу улучшить программу(код), что мне делать?</dt>
  <dd>https://git-scm.com/book/en/v2/GitHub-Contributing-to-a-Project</dd>
  
  <dt>Если у вас есть предложение/вопрос или вы нашли ошибку</dt>
  <dd>Пишите на почту ivmikhail собака gmail com, а еще лучше сюда https://github.com/ivmikhail/vtb24-miles/issues/</dd>
</dl>

### Лицензия/License

```
Copyright (c) 2017, Mikhail Ivanov <ivmikhail at gmail com>

Разрешается повторное распространение и использование как в виде исходного
кода, так и в двоичной форме, с изменениями или без, при соблюдении
следующих условий:

    * При повторном распространении исходного кода должно оставаться
      указанное выше уведомление об авторском праве, этот список условий и
      последующий отказ от гарантий.
    * При повторном распространении двоичного кода должна сохраняться
      указанная выше информация об авторском праве, этот список условий и
      последующий отказ от гарантий в документации и/или в других
      материалах, поставляемых при распространении.

ЭТА ПРОГРАММА ПРЕДОСТАВЛЕНА ВЛАДЕЛЬЦАМИ АВТОРСКИХ ПРАВ И/ИЛИ ДРУГИМИ
СТОРОНАМИ "КАК ОНА ЕСТЬ" БЕЗ КАКОГО-ЛИБО ВИДА ГАРАНТИЙ, ВЫРАЖЕННЫХ ЯВНО
ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ, НО НЕ ОГРАНИЧИВАЯСЬ ИМИ, ПОДРАЗУМЕВАЕМЫЕ
ГАРАНТИИ КОММЕРЧЕСКОЙ ЦЕННОСТИ И ПРИГОДНОСТИ ДЛЯ КОНКРЕТНОЙ ЦЕЛИ. НИ В
КОЕМ СЛУЧАЕ, ЕСЛИ НЕ ТРЕБУЕТСЯ СООТВЕТСТВУЮЩИМ ЗАКОНОМ, ИЛИ НЕ УСТАНОВЛЕНО
В УСТНОЙ ФОРМЕ, НИ ОДИН ВЛАДЕЛЕЦ АВТОРСКИХ ПРАВ И НИ ОДНО  ДРУГОЕ ЛИЦО,
КОТОРОЕ МОЖЕТ ИЗМЕНЯТЬ И/ИЛИ ПОВТОРНО РАСПРОСТРАНЯТЬ ПРОГРАММУ, КАК БЫЛО
СКАЗАНО ВЫШЕ, НЕ НЕСЁТ ОТВЕТСТВЕННОСТИ, ВКЛЮЧАЯ ЛЮБЫЕ ОБЩИЕ, СЛУЧАЙНЫЕ,
СПЕЦИАЛЬНЫЕ ИЛИ ПОСЛЕДОВАВШИЕ УБЫТКИ, ВСЛЕДСТВИЕ ИСПОЛЬЗОВАНИЯ ИЛИ
НЕВОЗМОЖНОСТИ ИСПОЛЬЗОВАНИЯ ПРОГРАММЫ (ВКЛЮЧАЯ, НО НЕ ОГРАНИЧИВАЯСЬ
ПОТЕРЕЙ ДАННЫХ, ИЛИ ДАННЫМИ, СТАВШИМИ НЕПРАВИЛЬНЫМИ, ИЛИ ПОТЕРЯМИ
ПРИНЕСЕННЫМИ ИЗ-ЗА ВАС ИЛИ ТРЕТЬИХ ЛИЦ, ИЛИ ОТКАЗОМ ПРОГРАММЫ РАБОТАТЬ
СОВМЕСТНО С ДРУГИМИ ПРОГРАММАМИ), ДАЖЕ ЕСЛИ ТАКОЙ ВЛАДЕЛЕЦ ИЛИ ДРУГОЕ
ЛИЦО БЫЛИ ИЗВЕЩЕНЫ О ВОЗМОЖНОСТИ ТАКИХ УБЫТКОВ.
```
